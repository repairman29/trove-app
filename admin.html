<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trove Admin Panel - Template Builder</title>
    <link rel="stylesheet" href="design-system.css">
    <style>
        /* Admin Panel Specific Styles */
        .admin-header {
            background: linear-gradient(135deg, var(--electric-magenta), var(--laser-green));
            padding: 20px 0;
            border-bottom: 2px solid var(--border-cyan);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .admin-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--bg-dark);
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin: 30px 0;
        }
        
        .admin-tab {
            padding: 12px 24px;
            background: transparent;
            border: 2px solid var(--electric-magenta);
            color: var(--electric-magenta);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .admin-tab.active {
            background: var(--electric-magenta);
            color: var(--bg-dark);
            box-shadow: 0 0 20px var(--glow-magenta);
        }
        
        .admin-tab:hover:not(.active) {
            background: rgba(255, 20, 147, 0.1);
            box-shadow: 0 0 15px var(--glow-magenta);
        }
        
        .admin-content {
            display: none;
        }
        
        .admin-content.active {
            display: block;
        }
        
        /* Template Builder Styles */
        .template-builder {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .builder-section {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .builder-section h3 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            margin-bottom: 20px;
            text-shadow: 0 0 8px var(--glow-green);
        }
        
        .template-form {
            display: grid;
            gap: 20px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-row.full {
            grid-template-columns: 1fr;
        }
        
        .icon-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .icon-option {
            padding: 15px;
            border: 2px solid var(--border-cyan);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }
        
        .icon-option:hover {
            border-color: var(--electric-magenta);
            box-shadow: 0 0 15px var(--glow-magenta);
        }
        
        .icon-option.selected {
            border-color: var(--laser-green);
            background: rgba(0, 255, 127, 0.1);
            box-shadow: 0 0 20px var(--glow-green);
        }
        
        /* Attribute Builder Styles */
        .attribute-builder {
            margin-top: 40px;
        }
        
        .attributes-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .attribute-item {
            background: var(--bg-dark);
            border: 1px solid var(--border-cyan);
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }
        
        .attribute-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .attribute-title {
            color: var(--cyan);
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .attribute-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 4px;
        }
        
        .attribute-config {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .predefined-values {
            display: none;
            margin-top: 15px;
        }
        
        .predefined-values.show {
            display: block;
        }
        
        .tags-input {
            position: relative;
        }
        
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        .tag {
            background: var(--electric-magenta);
            color: var(--bg-dark);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tag .remove {
            cursor: pointer;
            font-weight: bold;
        }
        
        .add-attribute-btn {
            width: 100%;
            padding: 20px;
            border: 2px dashed var(--border-cyan);
            background: transparent;
            color: var(--cyan);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .add-attribute-btn:hover {
            border-color: var(--laser-green);
            color: var(--laser-green);
            box-shadow: 0 0 15px var(--glow-green);
        }
        
        .template-preview {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .preview-form {
            display: grid;
            gap: 20px;
        }
        
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .template-card {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px var(--glow-cyan);
        }
        
        .template-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .template-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, var(--laser-green), var(--cyan));
            border-radius: 50%;
            color: var(--bg-dark);
        }
        
        .template-info h4 {
            color: var(--text-primary);
            margin: 0 0 5px 0;
            font-size: 1.2rem;
        }
        
        .template-info p {
            color: var(--text-secondary);
            margin: 0;
            font-size: 0.9rem;
        }
        
        .template-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-cyan);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .template-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .success-message {
            background: linear-gradient(135deg, var(--laser-green), var(--cyan));
            color: var(--bg-dark);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .error-message {
            background: linear-gradient(135deg, #ff4444, #ff8888);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        /* Template Verification Styles */
        .verification-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .verification-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .verification-queue {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .verification-card {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .verification-card h4 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .verification-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .verification-card .meta {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .verification-card .actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .verification-card .action-btn {
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .verification-card .approve-btn {
            background: linear-gradient(135deg, var(--laser-green), var(--cyan));
            color: var(--bg-dark);
            border: 1px solid var(--laser-green);
        }

        .verification-card .approve-btn:hover {
            background: linear-gradient(135deg, var(--cyan), var(--laser-green));
            border-color: var(--cyan);
        }

        .verification-card .reject-btn {
            background: linear-gradient(135deg, #ff4444, #ff8888);
            color: white;
            border: 1px solid #ff4444;
        }

        .verification-card .reject-btn:hover {
            background: linear-gradient(135deg, #ff8888, #ff4444);
            border-color: #ff8888;
        }

        .review-form {
            margin-top: 20px;
        }

        .review-form h4 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .decision-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .review-comments {
            margin-bottom: 15px;
        }

        .review-comments label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .review-comments textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-cyan);
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--text-primary);
            background: var(--bg-input);
            resize: vertical;
        }

        .quality-checklist {
            margin-top: 15px;
        }

        .quality-checklist label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .quality-checklist input[type="checkbox"] {
            width: 1.2rem;
            height: 1.2rem;
            accent-color: var(--electric-magenta);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background: var(--bg-card);
            margin: 5% auto;
            padding: 0;
            border: 2px solid var(--border-cyan);
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-cyan);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            margin: 0;
        }

        .modal-header .close {
            color: var(--text-secondary);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-header .close:hover {
            color: var(--electric-magenta);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border-cyan);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .template-preview {
            margin-bottom: 20px;
        }

        .template-preview h3 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 10px;
        }

        .template-attributes {
            margin: 15px 0;
        }

        .template-attributes h4 {
            color: var(--cyan);
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 10px;
        }

        .attribute-item {
            background: var(--bg-input);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            border: 1px solid var(--border-cyan);
        }

        .attribute-item .required {
            color: var(--electric-magenta);
            font-weight: bold;
        }

        .template-meta {
            background: var(--bg-input);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-cyan);
            margin-top: 15px;
        }

        .template-meta p {
            margin: 5px 0;
            color: var(--text-secondary);
        }

        /* Advanced Analytics Styles */
        .analytics-overview {
            margin-bottom: 30px;
        }

        .analytics-tabs {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .analytics-tab {
            padding: 10px 20px;
            background: transparent;
            border: 2px solid var(--border-cyan);
            color: var(--cyan);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .analytics-tab.active {
            background: var(--electric-magenta);
            color: var(--bg-dark);
            box-shadow: 0 0 20px var(--glow-magenta);
        }

        .analytics-tab:hover:not(.active) {
            background: rgba(255, 20, 147, 0.1);
            box-shadow: 0 0 15px var(--glow-magenta);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .chart-container {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .chart-placeholder {
            position: relative;
            height: 200px; /* Adjust height as needed */
            margin-top: 10px;
        }

        .chart-bars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 0 10px;
        }

        .bar {
            width: 10%; /* Adjust width as needed */
            background: var(--electric-magenta);
            border-radius: 5px;
            transition: height 0.5s ease-in-out;
        }

        .chart-labels {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .growth-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: var(--border-cyan);
            z-index: -1;
        }

        .growth-points {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .point {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--electric-magenta);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .insights-panel {
            margin-top: 30px;
            padding: 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
        }

        .insights-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .insight-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-icon {
            font-size: 1.5rem;
        }

        .insight-content strong {
            color: var(--laser-green);
        }

        .template-metrics, .user-metrics, .revenue-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border-cyan);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .metric-card h4 {
            color: var(--laser-green);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-shadow: 0 0 8px var(--glow-green);
        }

        .template-ranking {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .template-ranking .template-card {
            padding: 15px;
            border: 1px solid var(--border-cyan);
            border-radius: 8px;
            background: var(--bg-input);
        }

        .performance-metrics, .engagement-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-cyan);
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--laser-green);
        }

        .stat-change {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .stat-change.positive {
            color: var(--laser-green);
        }

        .stat-change.negative {
            color: #ff4444;
        }

        .revenue-chart {
            position: relative;
            height: 150px;
            margin-top: 10px;
        }

        .revenue-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(to bottom, var(--laser-green), var(--cyan));
            border-radius: 10px;
            overflow: hidden;
        }

        .revenue-label {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.7rem;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .revenue-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--laser-green);
        }

        .subscription-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .subscription-metrics .metric-item {
            padding: 10px 0;
        }
    </style>
</head>
<body>
    <header class="admin-header">
        <div class="container">
            <nav class="admin-nav">
                <div class="admin-logo">🏺 Trove Admin</div>
                <div class="user-info">
                    <span id="adminUserName">Administrator</span>
                    <button class="btn btn-secondary" onclick="returnToDashboard()">← Back to Dashboard</button>
                    <button class="btn btn-outline" onclick="handleLogout()">Logout</button>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Admin Tabs -->
        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchTab('builder')">Template Builder</button>
            <button class="admin-tab" onclick="switchTab('verification')">Template Verification</button>
            <button class="admin-tab" onclick="switchTab('manage')">Manage Templates</button>
            <button class="admin-tab" onclick="switchTab('analytics')">Analytics</button>
        </div>

        <!-- Template Builder Tab -->
        <div id="builder" class="admin-content active">
            <div class="template-builder">
                <div class="success-message" id="successMessage"></div>
                <div class="error-message" id="errorMessage"></div>
                
                <!-- Step 1: Basic Template Info -->
                <div class="builder-section">
                    <h3>📝 Step 1: Template Information</h3>
                    <form id="templateForm" class="template-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="templateName">Template Name *</label>
                                <input type="text" id="templateName" class="form-input" placeholder="e.g., Comic Books" required>
                                <small class="form-help">A clear, descriptive name for your template</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="templateDescription">Description *</label>
                                <input type="text" id="templateDescription" class="form-input" placeholder="Brief description of this collection type" required>
                                <small class="form-help">Explain what this template is used for</small>
                            </div>
                        </div>
                        
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label">Template Icon *</label>
                                <div class="icon-selector">
                                    <div class="icon-option" data-icon="📚">📚</div>
                                    <div class="icon-option" data-icon="🎮">🎮</div>
                                    <div class="icon-option" data-icon="🎵">🎵</div>
                                    <div class="icon-option" data-icon="🎬">🎬</div>
                                    <div class="icon-option" data-icon="🎨">🎨</div>
                                    <div class="icon-option" data-icon="⚽">⚽</div>
                                    <div class="icon-option" data-icon="🚗">🚗</div>
                                    <div class="icon-option" data-icon="🧸">🧸</div>
                                    <div class="icon-option" data-icon="💎">💎</div>
                                    <div class="icon-option" data-icon="🏺">🏺</div>
                                    <div class="icon-option" data-icon="📱">📱</div>
                                    <div class="icon-option" data-icon="👕">👕</div>
                                    <div class="icon-option" data-icon="🎯">🎯</div>
                                    <div class="icon-option" data-icon="🔧">🔧</div>
                                    <div class="icon-option" data-icon="💰">💰</div>
                                    <div class="icon-option" data-icon="🌟">🌟</div>
                                </div>
                                <small class="form-help">Select an icon to represent this collection type</small>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Step 2: Attribute Builder -->
                <div class="builder-section attribute-builder">
                    <h3>⚙️ Step 2: Define Attributes</h3>
                    <p class="text-secondary">Create custom fields that users will fill out for each item in this collection type.</p>
                    
                    <div class="attributes-list" id="attributesList">
                        <!-- Attributes will be dynamically added here -->
                    </div>
                    
                    <button type="button" class="add-attribute-btn" onclick="addAttribute()">
                        + Add New Attribute
                    </button>
                </div>

                <!-- Step 3: Preview -->
                <div class="builder-section template-preview">
                    <h3>👁️ Step 3: Preview</h3>
                    <p class="text-secondary">See how your template will look to users when they create items.</p>
                    
                    <div class="preview-form" id="previewForm">
                        <div class="form-group">
                            <label class="form-label">Item Name *</label>
                            <input type="text" class="form-input" placeholder="Required field for all items" disabled>
                        </div>
                        <!-- Dynamic preview fields will be added here -->
                    </div>
                </div>

                <!-- Save Template -->
                <div class="builder-section">
                    <div class="form-row">
                        <button type="button" class="btn btn-secondary" onclick="previewTemplate()">🔄 Update Preview</button>
                        <button type="button" class="btn btn-primary" onclick="saveTemplate()">💾 Save Template</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manage Templates Tab -->
        <div id="manage" class="admin-content">
            <div class="builder-section">
                <h3>📋 Manage Templates</h3>
                <p class="text-secondary">View, edit, and delete existing templates.</p>
                
                <div class="templates-grid" id="templatesGrid">
                    <!-- Templates will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Template Verification Tab -->
        <div id="verification" class="admin-content">
            <div class="builder-section">
                <h3>🔍 Template Verification</h3>
                <p class="text-secondary">Review and approve submitted templates for the Template Library</p>
                
                <div class="verification-stats">
                    <div class="stat-card">
                        <h3>Pending Review</h3>
                        <span class="stat-number" id="pending-count">0</span>
                    </div>
                    <div class="stat-card">
                        <h3>Approved Today</h3>
                        <span class="stat-number" id="approved-today">0</span>
                    </div>
                    <div class="stat-card">
                        <h3>Rejected Today</h3>
                        <span class="stat-number" id="rejected-today">0</span>
                    </div>
                </div>

                <div class="verification-filters">
                    <select id="verification-filter" class="neon-select">
                        <option value="pending">Pending Review</option>
                        <option value="approved">Approved</option>
                        <option value="rejected">Rejected</option>
                        <option value="all">All Templates</option>
                    </select>
                    <button id="refresh-verification" class="neon-button">🔄 Refresh</button>
                </div>

                <div class="verification-queue" id="verification-queue">
                    <!-- Template verification cards will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="admin-content">
            <div class="builder-section">
                <h3>📊 Advanced Analytics</h3>
                <p class="text-secondary">Comprehensive insights into template usage, user engagement, and platform performance.</p>
                
                <!-- Analytics Overview -->
                <div class="analytics-overview">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalTemplates">0</div>
                            <div class="stat-label">Total Templates</div>
                            <div class="stat-change positive">+12% this month</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalCollections">0</div>
                            <div class="stat-label">Collections Created</div>
                            <div class="stat-change positive">+8% this week</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeUsers">0</div>
                            <div class="stat-label">Active Users</div>
                            <div class="stat-change positive">+15% this month</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="revenue">$0</div>
                            <div class="stat-label">Monthly Revenue</div>
                            <div class="stat-change positive">+23% this month</div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Tabs -->
                <div class="analytics-tabs">
                    <button class="analytics-tab active" onclick="switchAnalyticsTab('overview')">Overview</button>
                    <button class="analytics-tab" onclick="switchAnalyticsTab('templates')">Template Analytics</button>
                    <button class="analytics-tab" onclick="switchAnalyticsTab('users')">User Analytics</button>
                    <button class="analytics-tab" onclick="switchAnalyticsTab('revenue')">Revenue Analytics</button>
                </div>

                <!-- Overview Tab -->
                <div id="overview-analytics" class="analytics-content active">
                    <div class="analytics-grid">
                        <div class="chart-container">
                            <h4>📈 Template Usage Trends</h4>
                            <div class="chart-placeholder" id="usage-chart">
                                <div class="chart-bars">
                                    <div class="bar" style="height: 60%"></div>
                                    <div class="bar" style="height: 80%"></div>
                                    <div class="bar" style="height: 45%"></div>
                                    <div class="bar" style="height: 90%"></div>
                                    <div class="bar" style="height: 70%"></div>
                                    <div class="bar" style="height: 85%"></div>
                                    <div class="bar" style="height: 75%"></div>
                                </div>
                                <div class="chart-labels">
                                    <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <h4>👥 User Growth</h4>
                            <div class="chart-placeholder" id="growth-chart">
                                <div class="growth-line"></div>
                                <div class="growth-points">
                                    <div class="point" style="left: 10%; top: 80%"></div>
                                    <div class="point" style="left: 25%; top: 70%"></div>
                                    <div class="point" style="left: 40%; top: 60%"></div>
                                    <div class="point" style="left: 55%; top: 50%"></div>
                                    <div class="point" style="left: 70%; top: 40%"></div>
                                    <div class="point" style="left: 85%; top: 30%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="insights-panel">
                        <h4>💡 Key Insights</h4>
                        <div class="insights-list">
                            <div class="insight-item">
                                <span class="insight-icon">🔥</span>
                                <div class="insight-content">
                                    <strong>Most Popular Template:</strong> Vintage Video Games (1,247 collections)
                                </div>
                            </div>
                            <div class="insight-item">
                                <span class="insight-icon">📈</span>
                                <div class="insight-content">
                                    <strong>Growth Trend:</strong> 23% increase in Pro subscriptions this month
                                </div>
                            </div>
                            <div class="insight-item">
                                <span class="insight-icon">⏰</span>
                                <div class="insight-content">
                                    <strong>Peak Usage:</strong> Tuesday evenings (7-9 PM) are most active
                                </div>
                            </div>
                            <div class="insight-item">
                                <span class="insight-icon">💰</span>
                                <div class="insight-content">
                                    <strong>Revenue:</strong> Average $12.45 per user this month
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Template Analytics Tab -->
                <div id="templates-analytics" class="analytics-content">
                    <div class="template-metrics">
                        <div class="metric-card">
                            <h4>🏆 Top Templates</h4>
                            <div class="template-ranking" id="template-ranking">
                                <!-- Template rankings will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <h4>📊 Template Performance</h4>
                            <div class="performance-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Average Collections per Template:</span>
                                    <span class="metric-value">156</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Template Adoption Rate:</span>
                                    <span class="metric-value">67%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">User Satisfaction Score:</span>
                                    <span class="metric-value">4.8/5</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Analytics Tab -->
                <div id="users-analytics" class="analytics-content">
                    <div class="user-metrics">
                        <div class="metric-card">
                            <h4>👥 User Demographics</h4>
                            <div class="demographics-chart">
                                <div class="demo-segment">
                                    <div class="demo-bar" style="width: 35%"></div>
                                    <span>Gaming Collectors (35%)</span>
                                </div>
                                <div class="demo-segment">
                                    <div class="demo-bar" style="width: 25%"></div>
                                    <span>Comic Collectors (25%)</span>
                                </div>
                                <div class="demo-segment">
                                    <div class="demo-bar" style="width: 20%"></div>
                                    <span>Music Collectors (20%)</span>
                                </div>
                                <div class="demo-segment">
                                    <div class="demo-bar" style="width: 20%"></div>
                                    <span>Other (20%)</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <h4>📱 User Engagement</h4>
                            <div class="engagement-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Daily Active Users:</span>
                                    <span class="metric-value">1,247</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Average Session Duration:</span>
                                    <span class="metric-value">18.5 min</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Retention Rate (30-day):</span>
                                    <span class="metric-value">68%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Revenue Analytics Tab -->
                <div id="revenue-analytics" class="analytics-content">
                    <div class="revenue-metrics">
                        <div class="metric-card">
                            <h4>💰 Revenue Overview</h4>
                            <div class="revenue-chart">
                                <div class="revenue-bar" style="height: 40%">
                                    <span class="revenue-label">Free</span>
                                    <span class="revenue-value">$0</span>
                                </div>
                                <div class="revenue-bar" style="height: 70%">
                                    <span class="revenue-label">Pro</span>
                                    <span class="revenue-value">$9.99</span>
                                </div>
                                <div class="revenue-bar" style="height: 100%">
                                    <span class="revenue-label">Patron</span>
                                    <span class="revenue-value">$19.99</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metric-card">
                            <h4>📊 Subscription Metrics</h4>
                            <div class="subscription-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Total Subscribers:</span>
                                    <span class="metric-value">847</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Monthly Recurring Revenue:</span>
                                    <span class="metric-value">$8,234</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Churn Rate:</span>
                                    <span class="metric-value">3.2%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Average Revenue Per User:</span>
                                    <span class="metric-value">$12.45</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Template Verification Section -->
        <section id="template-verification" class="admin-section" style="display: none;">
            <div class="section-header">
                <h2>🔍 Template Verification</h2>
                <p>Review and approve submitted templates for the Template Library</p>
            </div>

            <div class="verification-stats">
                <div class="stat-card">
                    <h3>Pending Review</h3>
                    <span class="stat-number" id="pending-count">0</span>
                </div>
                <div class="stat-card">
                    <h3>Approved Today</h3>
                    <span class="stat-number" id="approved-today">0</span>
                </div>
                <div class="stat-card">
                    <h3>Rejected Today</h3>
                    <span class="stat-number" id="rejected-today">0</span>
                </div>
            </div>

            <div class="verification-filters">
                <select id="verification-filter" class="neon-select">
                    <option value="pending">Pending Review</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                    <option value="all">All Templates</option>
                </select>
                <button id="refresh-verification" class="neon-button">🔄 Refresh</button>
            </div>

            <div class="verification-queue" id="verification-queue">
                <!-- Template verification cards will be loaded here -->
            </div>
        </section>

        <!-- Template Review Modal -->
        <div id="template-review-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>🔍 Review Template</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="template-preview">
                        <h3 id="review-template-name">Template Name</h3>
                        <p id="review-template-description">Description</p>
                        <div class="template-attributes">
                            <h4>Attributes:</h4>
                            <div id="review-attributes-list"></div>
                        </div>
                        <div class="template-meta">
                            <p><strong>Submitted by:</strong> <span id="review-submitter">User</span></p>
                            <p><strong>Submitted:</strong> <span id="review-date">Date</span></p>
                            <p><strong>Category:</strong> <span id="review-category">Category</span></p>
                        </div>
                    </div>
                    
                    <div class="review-form">
                        <h4>Review Decision</h4>
                        <div class="decision-buttons">
                            <button class="neon-button approve-btn" data-decision="approve">✅ Approve</button>
                            <button class="neon-button reject-btn" data-decision="reject">❌ Reject</button>
                        </div>
                        
                        <div class="review-comments">
                            <label for="review-comment">Review Comments:</label>
                            <textarea id="review-comment" placeholder="Add your review comments here..."></textarea>
                        </div>
                        
                        <div class="quality-checklist">
                            <h4>Quality Checklist</h4>
                            <label><input type="checkbox" id="check-description"> Clear description</label>
                            <label><input type="checkbox" id="check-attributes"> Appropriate attributes</label>
                            <label><input type="checkbox" id="check-category"> Correct category</label>
                            <label><input type="checkbox" id="check-examples"> Good examples</label>
                            <label><input type="checkbox" id="check-standards"> Follows standards</label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="submit-review" class="neon-button">Submit Review</button>
                    <button id="cancel-review" class="neon-button secondary">Cancel</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>
    
    <!-- Subscription Management -->
    <script src="subscription.js"></script>
    
    <!-- Template Builder Script -->
    <script src="template-builder.js"></script>
    
    <!-- Demo Setup Script -->
    <script src="setup-demo-admin.js"></script>
    
    <script>
        // Check authentication and admin privileges
        firebase.auth().onAuthStateChanged(async (user) => {
            if (user) {
                // Check if user has admin privileges or paid subscription
                const hasAccess = await checkAdminPrivileges(user);
                if (!hasAccess) {
                    alert('Access denied. Please upgrade to Pro to access Template Builder.');
                    window.location.href = 'app.html';
                    return;
                }
                
                // Check if user is actual admin
                const userDoc = await firebase.firestore().collection('users').doc(user.uid).get();
                const userData = userDoc.data();
                const isActualAdmin = userData?.role === 'admin' || userData?.role === 'support';
                
                // Hide analytics tab for non-admin users
                if (!isActualAdmin) {
                    document.querySelector('[data-tab="analytics"]').style.display = 'none';
                    document.getElementById('analytics').style.display = 'none';
                    // Set default tab to builder for paid users
                    document.querySelector('[data-tab="builder"]').click();
                }
                
                updateUserInfo(user);
                loadTemplates();
                if (isActualAdmin) {
                    loadAnalytics();
                }
            } else {
                window.location.href = 'auth.html';
            }
        });

        function updateUserInfo(user) {
            const userNameElement = document.getElementById('adminUserName');
            if (userNameElement) {
                userNameElement.textContent = user.displayName || user.email || 'Administrator';
            }
        }

        async function checkAdminPrivileges(user) {
            try {
                // Check if user has admin role OR paid subscription for Template Builder
                const userDoc = await firebase.firestore().collection('users').doc(user.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    // Admin users get full access
                    if (userData.role === 'admin' || userData.role === 'support') {
                        return true;
                    }
                    // Paid users get Template Builder access
                    const tier = userData.subscriptionTier || 'free';
                    return tier !== 'free';
                }
                return false;
            } catch (error) {
                console.error('Error checking admin privileges:', error);
                return false;
            }
        }

        function switchTab(tabName) {
            // Hide all content
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected content and activate tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Load content based on tab
            if (tabName === 'manage') {
                loadTemplates();
            } else if (tabName === 'analytics') {
                loadAnalytics();
            } else if (tabName === 'verification') {
                loadVerificationData();
            }
        }

        function returnToDashboard() {
            window.location.href = 'app.html';
        }

        async function handleLogout() {
            try {
                await firebase.auth().signOut();
            } catch (error) {
                console.error('Error signing out:', error);
                alert('Error signing out. Please try again.');
            }
        }

        // Initialize icon selection
        document.querySelectorAll('.icon-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.icon-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // Template Verification System
        let verificationData = {
            pendingTemplates: [],
            approvedToday: 0,
            rejectedToday: 0
        };

        async function loadVerificationData() {
            try {
                // Simulate loading verification data
                const mockTemplates = [
                    {
                        id: 'temp-001',
                        name: 'Vintage Video Games',
                        description: 'Complete template for cataloging vintage video games with condition, rarity, and value tracking',
                        category: 'Gaming',
                        submitter: 'retro_collector',
                        submittedDate: '2024-01-15',
                        status: 'pending',
                        attributes: [
                            { name: 'Title', type: 'text', required: true },
                            { name: 'Platform', type: 'select', options: ['NES', 'SNES', 'N64', 'PS1', 'PS2'] },
                            { name: 'Condition', type: 'select', options: ['Mint', 'Near Mint', 'Good', 'Fair', 'Poor'] },
                            { name: 'Year', type: 'number', required: true },
                            { name: 'Rarity', type: 'select', options: ['Common', 'Uncommon', 'Rare', 'Very Rare', 'Ultra Rare'] },
                            { name: 'Estimated Value', type: 'currency' },
                            { name: 'Notes', type: 'textarea' }
                        ]
                    },
                    {
                        id: 'temp-002',
                        name: 'Comic Books',
                        description: 'Professional comic book collection template with grading and publisher details',
                        category: 'Comics',
                        submitter: 'comic_fan',
                        submittedDate: '2024-01-14',
                        status: 'pending',
                        attributes: [
                            { name: 'Title', type: 'text', required: true },
                            { name: 'Issue Number', type: 'number', required: true },
                            { name: 'Publisher', type: 'text', required: true },
                            { name: 'Grade', type: 'select', options: ['10.0', '9.8', '9.6', '9.4', '9.2', '9.0', '8.5', '8.0', '7.5', '7.0'] },
                            { name: 'Cover Artist', type: 'text' },
                            { name: 'Writer', type: 'text' },
                            { name: 'Year', type: 'number', required: true },
                            { name: 'Estimated Value', type: 'currency' },
                            { name: 'Notes', type: 'textarea' }
                        ]
                    },
                    {
                        id: 'temp-003',
                        name: 'Vinyl Records',
                        description: 'Vinyl record collection template with pressing details and condition tracking',
                        category: 'Music',
                        submitter: 'vinyl_lover',
                        submittedDate: '2024-01-13',
                        status: 'approved',
                        attributes: [
                            { name: 'Album Title', type: 'text', required: true },
                            { name: 'Artist', type: 'text', required: true },
                            { name: 'Year', type: 'number', required: true },
                            { name: 'Label', type: 'text' },
                            { name: 'Pressing', type: 'text' },
                            { name: 'Condition', type: 'select', options: ['Mint', 'Near Mint', 'Very Good Plus', 'Very Good', 'Good Plus', 'Good', 'Fair', 'Poor'] },
                            { name: 'Genre', type: 'text' },
                            { name: 'Estimated Value', type: 'currency' },
                            { name: 'Notes', type: 'textarea' }
                        ]
                    }
                ];

                verificationData.pendingTemplates = mockTemplates.filter(t => t.status === 'pending');
                verificationData.approvedToday = mockTemplates.filter(t => t.status === 'approved').length;
                verificationData.rejectedToday = 0;

                updateVerificationStats();
                renderVerificationQueue();
            } catch (error) {
                console.error('Error loading verification data:', error);
                showNotification('Error loading verification data', 'error');
            }
        }

        function updateVerificationStats() {
            document.getElementById('pending-count').textContent = verificationData.pendingTemplates.length;
            document.getElementById('approved-today').textContent = verificationData.approvedToday;
            document.getElementById('rejected-today').textContent = verificationData.rejectedToday;
        }

        function renderVerificationQueue() {
            const queue = document.getElementById('verification-queue');
            const filter = document.getElementById('verification-filter').value;
            
            let templatesToShow = verificationData.pendingTemplates;
            if (filter === 'approved') {
                templatesToShow = verificationData.pendingTemplates.filter(t => t.status === 'approved');
            } else if (filter === 'rejected') {
                templatesToShow = verificationData.pendingTemplates.filter(t => t.status === 'rejected');
            } else if (filter === 'all') {
                templatesToShow = verificationData.pendingTemplates;
            }

            queue.innerHTML = templatesToShow.map(template => `
                <div class="verification-card" data-template-id="${template.id}">
                    <h4>${template.name}</h4>
                    <p>${template.description}</p>
                    <div class="meta">
                        <strong>Category:</strong> ${template.category}<br>
                        <strong>Submitted by:</strong> ${template.submitter}<br>
                        <strong>Date:</strong> ${template.submittedDate}
                    </div>
                    <div class="actions">
                        <button class="action-btn approve-btn" onclick="reviewTemplate('${template.id}', 'approve')">
                            ✅ Approve
                        </button>
                        <button class="action-btn reject-btn" onclick="reviewTemplate('${template.id}', 'reject')">
                            ❌ Reject
                        </button>
                        <button class="action-btn" onclick="viewTemplateDetails('${template.id}')">
                            👁️ View Details
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function reviewTemplate(templateId, decision) {
            const template = verificationData.pendingTemplates.find(t => t.id === templateId);
            if (!template) return;

            // Populate review modal
            document.getElementById('review-template-name').textContent = template.name;
            document.getElementById('review-template-description').textContent = template.description;
            document.getElementById('review-submitter').textContent = template.submitter;
            document.getElementById('review-date').textContent = template.submittedDate;
            document.getElementById('review-category').textContent = template.category;

            // Render attributes
            const attributesList = document.getElementById('review-attributes-list');
            attributesList.innerHTML = template.attributes.map(attr => `
                <div class="attribute-item">
                    <strong>${attr.name}</strong> (${attr.type})
                    ${attr.required ? '<span class="required">*</span>' : ''}
                    ${attr.options ? `<br><small>Options: ${attr.options.join(', ')}</small>` : ''}
                </div>
            `).join('');

            // Store template for review
            currentReviewTemplate = template;
            currentReviewDecision = decision;

            // Show modal
            document.getElementById('template-review-modal').style.display = 'block';
        }

        function viewTemplateDetails(templateId) {
            const template = verificationData.pendingTemplates.find(t => t.id === templateId);
            if (!template) return;

            // Show template details in a modal or expand the card
            showNotification(`Viewing details for ${template.name}`, 'info');
        }

        let currentReviewTemplate = null;
        let currentReviewDecision = null;

        async function submitReview() {
            if (!currentReviewTemplate || !currentReviewDecision) return;

            const comment = document.getElementById('review-comment').value;
            const checklist = {
                description: document.getElementById('check-description').checked,
                attributes: document.getElementById('check-attributes').checked,
                category: document.getElementById('check-category').checked,
                examples: document.getElementById('check-examples').checked,
                standards: document.getElementById('check-standards').checked
            };

            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1000));

                // Update template status
                currentReviewTemplate.status = currentReviewDecision;
                currentReviewTemplate.reviewComment = comment;
                currentReviewTemplate.reviewChecklist = checklist;
                currentReviewTemplate.reviewedAt = new Date().toISOString();

                // Update stats
                if (currentReviewDecision === 'approved') {
                    verificationData.approvedToday++;
                } else if (currentReviewDecision === 'rejected') {
                    verificationData.rejectedToday++;
                }

                // Remove from pending
                verificationData.pendingTemplates = verificationData.pendingTemplates.filter(
                    t => t.id !== currentReviewTemplate.id
                );

                updateVerificationStats();
                renderVerificationQueue();

                // Close modal
                document.getElementById('template-review-modal').style.display = 'none';
                
                // Reset form
                document.getElementById('review-comment').value = '';
                document.querySelectorAll('.quality-checklist input').forEach(cb => cb.checked = false);

                showNotification(
                    `Template "${currentReviewTemplate.name}" ${currentReviewDecision}`, 
                    currentReviewDecision === 'approved' ? 'success' : 'warning'
                );

                currentReviewTemplate = null;
                currentReviewDecision = null;

            } catch (error) {
                console.error('Error submitting review:', error);
                showNotification('Error submitting review', 'error');
            }
        }

        // Event listeners for verification system
        document.addEventListener('DOMContentLoaded', function() {
            // Verification filter change
            document.getElementById('verification-filter').addEventListener('change', renderVerificationQueue);
            
            // Refresh verification data
            document.getElementById('refresh-verification').addEventListener('click', loadVerificationData);
            
            // Review modal events
            document.getElementById('submit-review').addEventListener('click', submitReview);
            document.getElementById('cancel-review').addEventListener('click', function() {
                document.getElementById('template-review-modal').style.display = 'none';
                currentReviewTemplate = null;
                currentReviewDecision = null;
            });

            // Close modal on X click
            document.querySelector('#template-review-modal .close').addEventListener('click', function() {
                document.getElementById('template-review-modal').style.display = 'none';
            });

            // Close modal on outside click
            window.addEventListener('click', function(event) {
                const modal = document.getElementById('template-review-modal');
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // Advanced Analytics System
        function switchAnalyticsTab(tabName) {
            // Hide all analytics content
            document.querySelectorAll('.analytics-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all analytics tabs
            document.querySelectorAll('.analytics-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected content and activate tab
            document.getElementById(tabName + '-analytics').classList.add('active');
            event.target.classList.add('active');
            
            // Load specific analytics data
            if (tabName === 'templates') {
                loadTemplateAnalytics();
            } else if (tabName === 'users') {
                loadUserAnalytics();
            } else if (tabName === 'revenue') {
                loadRevenueAnalytics();
            }
        }

        async function loadAnalytics() {
            try {
                // Simulate loading analytics data
                const mockData = {
                    totalTemplates: 24,
                    totalCollections: 1247,
                    activeUsers: 847,
                    revenue: 8234,
                    templateRankings: [
                        { name: 'Vintage Video Games', collections: 1247, growth: '+15%' },
                        { name: 'Comic Books', collections: 892, growth: '+8%' },
                        { name: 'Vinyl Records', collections: 654, growth: '+12%' },
                        { name: 'Trading Cards', collections: 543, growth: '+5%' },
                        { name: 'Action Figures', collections: 432, growth: '+18%' }
                    ]
                };

                // Update overview stats
                document.getElementById('totalTemplates').textContent = mockData.totalTemplates;
                document.getElementById('totalCollections').textContent = mockData.totalCollections.toLocaleString();
                document.getElementById('activeUsers').textContent = mockData.activeUsers.toLocaleString();
                document.getElementById('revenue').textContent = '$' + mockData.revenue.toLocaleString();

                // Load template rankings
                loadTemplateRankings(mockData.templateRankings);

                // Animate charts
                animateCharts();

            } catch (error) {
                console.error('Error loading analytics:', error);
                showNotification('Error loading analytics data', 'error');
            }
        }

        function loadTemplateRankings(rankings) {
            const rankingContainer = document.getElementById('template-ranking');
            if (!rankingContainer) return;

            rankingContainer.innerHTML = rankings.map((template, index) => `
                <div class="template-card">
                    <div class="template-rank">#${index + 1}</div>
                    <div class="template-info">
                        <div class="template-name">${template.name}</div>
                        <div class="template-stats">
                            <span class="collections-count">${template.collections.toLocaleString()} collections</span>
                            <span class="growth-rate ${template.growth.includes('+') ? 'positive' : 'negative'}">${template.growth}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function animateCharts() {
            // Animate usage chart bars
            const bars = document.querySelectorAll('.chart-bars .bar');
            bars.forEach((bar, index) => {
                setTimeout(() => {
                    bar.style.height = bar.style.height;
                    bar.style.animation = 'barGrow 0.8s ease-out';
                }, index * 100);
            });

            // Animate growth chart points
            const points = document.querySelectorAll('.growth-points .point');
            points.forEach((point, index) => {
                setTimeout(() => {
                    point.style.animation = 'pointPulse 0.6s ease-out';
                }, index * 150);
            });
        }

        function loadTemplateAnalytics() {
            // Template-specific analytics loading
            console.log('Loading template analytics...');
        }

        function loadUserAnalytics() {
            // User-specific analytics loading
            console.log('Loading user analytics...');
        }

        function loadRevenueAnalytics() {
            // Revenue-specific analytics loading
            console.log('Loading revenue analytics...');
        }

        // Add CSS animations for charts
        const style = document.createElement('style');
        style.textContent = `
            @keyframes barGrow {
                from { height: 0%; }
                to { height: var(--target-height); }
            }
            
            @keyframes pointPulse {
                0% { transform: translate(-50%, -50%) scale(0); }
                50% { transform: translate(-50%, -50%) scale(1.2); }
                100% { transform: translate(-50%, -50%) scale(1); }
            }
            
            .demo-segment {
                display: flex;
                align-items: center;
                gap: 10px;
                margin: 10px 0;
            }
            
            .demo-bar {
                height: 20px;
                background: linear-gradient(90deg, var(--laser-green), var(--cyan));
                border-radius: 10px;
                transition: width 0.8s ease-out;
            }
            
            .template-card {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px;
                border: 1px solid var(--border-cyan);
                border-radius: 8px;
                background: var(--bg-input);
            }
            
            .template-rank {
                font-size: 1.5rem;
                font-weight: bold;
                color: var(--electric-magenta);
                min-width: 40px;
            }
            
            .template-info {
                flex: 1;
            }
            
            .template-name {
                font-weight: 600;
                color: var(--text-primary);
                margin-bottom: 5px;
            }
            
            .template-stats {
                display: flex;
                justify-content: space-between;
                font-size: 0.9rem;
            }
            
            .collections-count {
                color: var(--text-secondary);
            }
            
            .growth-rate {
                font-weight: 600;
            }
            
            .growth-rate.positive {
                color: var(--laser-green);
            }
            
            .growth-rate.negative {
                color: #ff4444;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>